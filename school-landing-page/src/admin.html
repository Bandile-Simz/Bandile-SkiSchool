<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>School Management Dashboard</title>
    <link rel="icon" href="images/OOP.png" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/css/lightbox.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <!-- Include Font Awesome for Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="css/adminStyle.css" />
    <link rel="stylesheet" href="css/animation.css" />
    <style>
        #wrapper {
            display: flex;
            width: 100%;
            transition: all 0.3s ease;
        }

        /* Sidebar styling */
        #sidebar-wrapper {
            width: 250px;
            background-color: #1E3A8A;
            height: 100%;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding-top: 20px;
        }

        #sidebar-wrapper .sidebar-heading {
            color: white;
            font-size: 1.5rem;
            padding: 1rem;
            text-align: center;
            background-color: #1E3A8A;
            width: 100%;
        }

        #sidebar-wrapper .list-group-item {
            color: white;
            background-color: #1E3A8A;
            width: 100%;
            text-align: center;
        }

        #sidebar-wrapper .list-group-item:hover {
            background-color: #0d45e039;
            color: gold;
        }

        #page-content-wrapper {
            flex: 1;
            transition: all 0.3s ease;
            margin-left: 250px;
            /* Show sidebar by default */
        }

        #wrapper.toggled #sidebar-wrapper {
            margin-left: -250px;
            /* Hide sidebar */
        }

        #wrapper.toggled #page-content-wrapper {
            margin-left: 0;
            /* Adjust content when sidebar is hidden */
        }

        /* Mobile styling */
        @media (max-width: 768px) {
            #sidebar-wrapper {
                margin-left: -250px;
            }

            #wrapper.toggled #sidebar-wrapper {
                margin-left: 0;
            }

            #page-content-wrapper {
                margin-left: 0;
            }

            #wrapper.toggled #page-content-wrapper {
                margin-left: 250px;
            }
        }

        /* Navbar Styles */
        .navbar {
            background-color: #f8f9fa;
            /* Light background */
            border-bottom: 1px solid #e0e0e0;
            /* Subtle border */
            justify-content: flex-end;
            /* Align items to the right */
        }

        .navbar-toggler {
            border: none;
            /* Remove border */
        }

        .main-content {
            display: flex;
            /* Flexbox for layout */
            align-items: center;
            /* Center items vertically */
            padding: 1rem;
            /* Padding for spacing */
        }

        .profile-header {
            display: flex;
            /* Flexbox for profile layout */
            align-items: center;
            /* Center items vertically */
        }

        #profile-picture {
            border-radius: 50%;
            /* Circular profile picture */
            width: 50px;
            /* Fixed width */
            height: 50px;
            /* Fixed height */
            margin-right: 1rem;
            /* Space between image and text */
        }

        .profile-info {
            flex-grow: 1;
            /* Allow info to grow */
        }

        h2 {
            margin: 0;
            /* Remove default margin */
            font-size: 1.25rem;
            /* Heading size */
        }

        p {
            margin: 0.25rem 0;
            /* Spacing between paragraphs */
            font-size: 0.9rem;
            /* Paragraph size */
            color: #555;
            /* Darker color for text */
        }

        .profile-actions {
            display: flex;
            /* Flexbox for buttons */
            gap: 0.5rem;
            /* Space between buttons */
        }

        button {
            background-color: #a3acb6;
            /* Button color */
            color: white;
            /* Text color */
            border: none;
            /* Remove border */
            padding: 0.5rem 1rem;
            /* Padding for buttons */
            border-radius: 0.25rem;
            /* Rounded corners */
            cursor: pointer;
            /* Pointer cursor on hover */
            transition: background-color 0.3s;
            /* Smooth background transition */
        }

        button:hover {
            background-color: #a7acb1;
            /* Darker blue on hover */
        }

        /* Responsive Design */
        @media (max-width: 576px) {
            .main-content {
                flex-direction: column;
                /* Stack elements on smaller screens */
                align-items: flex-end;
                /* Align items to the right */
            }

            .profile-header {
                width: auto;
                /* Auto width for profile */
            }

            #profile-picture {
                width: 40px;
                /* Smaller image for mobile */
                height: 40px;
                /* Smaller image for mobile */
            }

            h2 {
                font-size: 1rem;
                /* Smaller heading for mobile */
            }

            p {
                font-size: 0.8rem;
                /* Smaller text for mobile */
            }
        }

        /* Custom styles for the gallery section */
        #gallery {
            background-color: #f7fafc;
            /* Light gray background */
            border-radius: 0.5rem;
        }

        #upload-image-form,
        #hero-image-form {
            background-color: #ffffff;
            /* White background for forms */
            border-radius: 0.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            /* Subtle shadow */
        }

        #upload-image-form h3,
        #hero-image-form h3 {
            color: #2c3e50;
            /* Darker title color */
        }

        #gallery-container .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 0.5rem;
            /* Rounded corners for images */
            transition: transform 0.3s;
            /* Smooth transition on hover */
        }

        #gallery-container .gallery-item:hover {
            transform: scale(1.05);
            /* Slight zoom effect on hover */
        }

        .nav-button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            margin-right: 10px;
            /* Space between buttons */
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .nav-button:hover {
            background-color: #e2e8f0;
            /* Light gray on hover */
        }

        #current-image-display img {
            max-width: 100%;
            /* Responsive image display */
            height: auto;
            /* Maintain aspect ratio */
        }

        .bg-midnight-blue {
            background-color: #2c3e50;
            /* Midnight blue background */
        }

        .hover\:bg-blue-700:hover {
            background-color: #1a1a2e;
            /* Darker blue on hover */
        }

        .hidden {
            display: none;
        }

        /* Table Container */
        #students-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            background-color: #ffffff;
        }

        /* Table Header */
        #students-table thead {
            background-color: #007bff;
            /* Primary color */
            color: #070707;
        }

        #students-table th {
            padding: 10px;
            text-align: left;
        }

        /* Table Body */
        #students-table tbody tr {
            border-bottom: 1px solid #dddddd;
        }

        #students-table tbody tr:hover {
            background-color: #f1f1f1;
            /* Light gray background on hover */
        }

        #students-table td {
            padding: 10px;
        }

        /* Input Styles */
        #students-table input[type="text"] {
            width: 90%;
            /* Make input fields responsive */
            padding: 5px;
            border: 1px solid #dddddd;
            border-radius: 4px;
            box-sizing: border-box;
            /* Ensures padding is included in total width */
        }

        /* Button Styles */
        .edit-button,
        .delete-button,
        .save-button {
            background-color: #007bff;
            /* Primary color */
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .edit-button:hover,
        .delete-button:hover,
        .save-button:hover {
            background-color: #0056b3;
            /* Darker shade on hover */
        }

        .delete-button {
            background-color: #dc3545;
            /* Danger color */
        }

        .delete-button:hover {
            background-color: #c82333;
            /* Darker shade on hover */
        }

        .save-button {
            background-color: #28a745;
            /* Success color */
        }

        .save-button:hover {
            background-color: #218838;
            /* Darker shade on hover */
        }

        /* Search Input and Class Filter Styles */
        #search-input {
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #dddddd;
            border-radius: 4px;
            width: calc(25% - 22px);
            /* Full width minus padding and border */
        }


        #class-filter {
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #dddddd;
            border-radius: 4px;
            width: calc(15% - 22px);
            /* Full width minus padding and border */
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            #students-table {
                font-size: 14px;
                /* Smaller font on smaller screens */
            }

        }

        /* Custom styles for the timetable section */
        #timetable-section {
            background-color: #f8fafc;
            /* Light gray background */
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            /* Subtle shadow */
            margin-top: 2rem;
        }

        #timetable-section h2,
        #timetable-section h3 {
            color: #1e3a8a;
            /* Midnight blue */
        }

        #timetable-section form label {
            font-weight: 600;
            color: #1e293b;
            width: 30%;
            /* Dark gray */
        }

        #timetable-section form input,
        form select {
            width: 100%;
            padding: 0.75rem;
            margin-top: 0.25rem;
            border-radius: 0.5rem;
            border: 1px solid #cbd5e1;
            /* Light gray border */
            background-color: #fff;
            transition: border-color 0.3s ease;
        }

        #timetable-section form input:focus,
        form select:focus {
            border-color: #1e3a8a;
            /* Change border color when focused */
            outline: none;
        }

        #timetable-section form button {
            background-color: #1e3a8a;
            /* Midnight blue */
            color: white;
            padding: 0.75rem 1.5rem;
            margin-top: 1rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #timetable-section form button:hover {
            background-color: #3b82f6;
            /* Lighter blue on hover */
        }

        /* Timetable table */
        #timetable-section table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
            background-color: white;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            /* Subtle table shadow */
        }

        #timetable-section table th,
        table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
            /* Light gray border for rows */
            color: #1e293b;
            /* Dark text */
        }

        #timetable-section table th {
            background-color: #f1f5f9;
            /* Light background for headers */
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05rem;
            color: #1e3a8a;
            /* Midnight blue */
        }

        #timetable-section table tr:nth-child(even) {
            background-color: #f8fafc;
            /* Alternate row background */
        }
    </style>
</head>

<body>
    <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <div class="sidebar-heading">School Management</div>
            <div class="list-group list-group-flush">
                <a href="#" class="list-group-item list-group-item-action" data-target="#dashboard"><i
                        class="fas fa-tachometer-alt"></i> Dashboard</a>
                <a href="#" class="list-group-item list-group-item-action" data-target="#students"><i
                        class="fas fa-user-graduate"></i> Students</a>
                <a href="#" class="list-group-item list-group-item-action" data-target="#teachers"><i
                        class="fas fa-chalkboard-teacher"></i> Teachers</a>
                <a href="#" class="list-group-item list-group-item-action" data-target="#classes"><i
                        class="fas fa-door-open"></i> Classes</a>
                <a href="#" class="list-group-item list-group-item-action" data-target="#events"><i
                        class="fas fa-calendar-alt"></i> Events</a>
                <a href="#" class="list-group-item list-group-item-action" data-target="#news"><i
                        class="fas fa-newspaper"></i> News</a>
                <a href="#" class="list-group-item list-group-item-action" data-target="#gallery"><i
                        class="fas fa-images"></i> Gallery</a>
                <a href="#" class="list-group-item list-group-item-action" data-target="#timetable-section"><i
                        class="fas fa-calendar"></i>Timetable</a>
                <a href="#" class="list-group-item list-group-item-action" data-target="#settings"><i
                        class="fas fa-cog"></i> Settings</a>
            </div>
        </div>

        <!-- Page Content -->
        <di id="page-content-wrapper">
            <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
                <button class="navbar-toggler" type="button" id="menu-toggle">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="main-content">
                    <div class="profile-header">
                        <img id="profile-picture" src="" alt="Profile Picture" />
                        <div class="profile-info">
                            <input type="text" id="name-input" class="editable" style="display: none" />
                            <span id="name" class="non-editable"></span>
                            <input type="email" id="email-input" class="editable" style="display: none" />
                            <span id="email" class="non-editable"></span>
                        </div>
                        <div class="profile-actions">
                            <button id="edit-profile">
                                <i class="fas fa-edit"></i> Edit Profile
                            </button>
                            <button id="logout-button">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </button>
                        </div>
                    </div>

                    <div class="upload-image">
                        <input type="file" id="image-input" accept="image/*" style="display: none" />
                        <button id="change-image" style="display: none">
                            Change Profile Picture
                        </button>
                    </div>
                </div>
            </nav>

            <h1 class="mt-4 text-center">
                Welcome to School Management Dashboard
            </h1>

            <div id="dashboard" class="content-section active">
                <h2>Dashboard</h2>
                <div class="row">
                    <div class="col-md-4 col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="fas fa-user-graduate"></i> Total Students
                                </h5>
                                <p class="card-text" id="total-students">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="fas fa-chalkboard-teacher"></i> Total Teachers
                                </h5>
                                <p class="card-text" id="total-teachers">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="fas fa-calendar-alt"></i> Total Events
                                </h5>
                                <p class="card-text" id="total-events">0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="students" class="content-section">
                <h2 class="text-2xl font-bold mb-4 text-midnight-blue">
                    <i class="fas fa-user-graduate"></i> Students Section
                </h2>
                <h3 class="text-xl font-bold mb-2">Registration</h3>
                <table id="applications-table" class="table table-bordered">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>Date of Birth</th>
                            <th>Gender</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Address</th>
                            <th>Previous School</th>
                            <th>Class </th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Rows will be populated here by JavaScript -->
                    </tbody>
                </table>

                <h3 class="text-xl font-bold mb-2 mt-8">Students List</h3>

                <input type="text" id="search-input" placeholder=" Search students..." oninput="filterStudents()" />
                <select id="class-filter" onchange="filterStudents()">
                    <option value="">All Classes</option>
                    <!-- Options populated by fetchClasses -->
                </select>

                <table id="students-table">
                    <thead>
                        <tr>
                            <th onclick="sortTable(0)">ID</th>
                            <th onclick="sortTable(1)">User ID</th>
                            <th onclick="sortTable(2)">First Name</th>
                            <th onclick="sortTable(3)">Last Name</th>
                            <th onclick="sortTable(4)">DOB</th>
                            <th onclick="sortTable(5)">Gender</th>
                            <th onclick="sortTable(6)">Email</th>
                            <th onclick="sortTable(7)">Phone</th>
                            <th onclick="sortTable(8)">Address</th>
                            <th onclick="sortTable(9)">Previous School</th>
                            <th onclick="sortTable(10)">Class Name</th>
                            <th onclick="sortTable(11)">Results</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Student rows will be dynamically added here -->
                    </tbody>
                </table>
            </div>
            <script>
                document
                    .getElementById("add-student-btn")
                    .addEventListener("click", function () {
                        const form = document.getElementById("registration-form");
                        form.classList.toggle("hidden");
                    });
            </script>

            <div id="teachers" class="content-section p-8 bg-gray-200">
                <h2 class="text-2xl font-bold mb-4 text-midnight-blue">
                    <i class="fas fa-chalkboard-teacher"></i> Teachers Section
                </h2>

                <button class="btn btn-primary mt-5 pt-2 mb-5" id="openModalBtn">
                    Add Teacher
                </button>

                <!-- The Modal -->
                <div id="formModal" class="modal t">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <form id="add-teacher-form">
                            <h2>Add Teacher</h2>
                            <div class="form-section">
                                <label for="first-name">Full Name</label>
                                <input type="text" id="full-name" placeholder="Enter full name" required />
                            </div>

                            <div class="form-section">
                                <label for="email">Email</label>
                                <input type="email" id="email" placeholder="Enter email address" required />
                            </div>
                            <div class="form-section">
                                <label for="phone">Phone Number</label>
                                <input type="text" id="phone" placeholder="Enter phone number" required />
                            </div>
                            <div class="form-section">
                                <label for="subject">Subject</label>
                                <input type="text" id="subject" placeholder="Enter subject" required />
                            </div>
                            <button type="submit">Add Teacher</button>
                        </form>
                    </div>
                </div>
                <script>
                    // Get modal elements
                    var modal = document.getElementById("formModal");
                    var btn = document.getElementById("openModalBtn");
                    var span = document.getElementsByClassName("close")[0];

                    // Open modal on button click
                    btn.onclick = function () {
                        modal.style.display = "block";
                    };

                    // Close modal on 'x' click
                    span.onclick = function () {
                        modal.style.display = "none";
                    };

                    // Close modal if clicked outside of modal content
                    window.onclick = function (event) {
                        if (event.target == modal) {
                            modal.style.display = "none";
                        }
                    };
                </script>
                <div id="teachers">
                    <table id="teachers-table">
                        <thead>
                            <tr>
                                <th>user ID</th>
                                <th>full Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Subject</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Teacher rows will be appended here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="classes" class="content-section p-8 bg-gray-200">
                <h2 class="text-2xl font-bold mb-4 text-midnight-blue">
                    <i class="fas fa-chalkboard"></i> Classes Section
                </h2>

                <!-- Add Class Form -->
                <form id="add-class-form" class="mb-4">
                    <input type="number" id="classID" placeholder="Class ID" class="border p-2 rounded mr-2" required />
                    <input type="text" id="className" placeholder="Class Name" class="border p-2 rounded mr-2"
                        required />
                    <input type="text" id="teacher" placeholder="Teacher" class="border p-2 rounded mr-2" />
                    <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">
                        <i class="fas fa-plus"></i> Add Class
                    </button>
                </form>

                <table id="classes-table" class="table-auto w-full bg-white shadow-md">
                    <thead>
                        <tr>
                            <th class="px-4 py-2">Class ID</th>
                            <th class="px-4 py-2">Class Name</th>
                            <th class="px-4 py-2">Teacher</th>
                            <th class="px-4 py-2">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Classes will be dynamically loaded here -->
                    </tbody>
                </table>
            </div>

            <div id="events" class="content-section py-20 bg-gray-200">
                <div class="container mx-auto px-6">
                    <h2 class="text-4xl font-bold mb-4 text-midnight-blue">
                        <i class="fas fa-calendar-alt"></i> Events Section
                    </h2>

                    <!-- Button to open the Add Event modal -->
                    <button onclick="toggleAddEventModal()"
                        class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded mb-4 transition">
                        Add New Event
                    </button>

                    <!-- Add New Event Modal -->
                    <div id="addEventModal" class="fixed inset-49 flex items-center justify-center z-50"
                        style="display: none; z-index: 3000">
                        <div class="bg-white shadow-lg rounded-lg p-6 max-w-md w-full">
                            <h3 class="text-2xl font-semibold mb-4">Add New Event</h3>
                            <input type="text" id="newEventTitle" placeholder="Event Title"
                                class="border border-gray-300 p-2 mb-4 w-full rounded" required />
                            <input type="datetime-local" id="newEventDateTime"
                                class="border border-gray-300 p-2 mb-4 w-full rounded" required />
                            <textarea id="newEventDescription" placeholder="Event Description"
                                class="border border-gray-300 p-2 mb-4 w-full rounded" required></textarea>
                            <input type="file" accept="image/*" id="newEventImage"
                                class="border border-gray-300 mb-4 w-full rounded" required />
                            <div class="flex justify-end">
                                <button onclick="addNewEvent()"
                                    class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded mr-2 transition">
                                    Add Event
                                </button>
                                <button onclick="toggleAddEventModal()"
                                    class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition">
                                    Cancel
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="events-container">
                        <!-- Events will be dynamically inserted here -->
                    </div>
                </div>
            </div>

            <div id="news" class="content-section p-8 bg-gray-100">
                <h2 class="text-2xl font-bold mb-4 text-midnight-blue">
                    <i class="fas fa-newspaper"></i> News Section
                </h2>
                <button onclick="toggleAddNewsModal()"
                    class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded mb-4 transition">
                    Add New Article
                </button>

                <div id="news-container" class="flex flex-wrap justify-center">
                    <!-- News cards will be dynamically inserted here -->
                </div>

                <!-- Modal for Adding New News Article -->
                <div id="addNewsModal"
                    class="fixed top-10 mt-32 -ml-8 inset-45 flex items-center justify-center z-50 bg-black bg-opacity-0"
                    style="display: none; z-index: 4000">
                    <div class="modal-content bg-white rounded-lg shadow-lg p-8 max-w-lg w-full relative">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">
                            Add New News Article
                        </h2>

                        <div class="space-y-4">
                            <input type="text" id="newNewsTitle"
                                class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                placeholder="Article Title" required />

                            <input type="datetime-local" id="newNewsDateTime"
                                class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                required />

                            <textarea id="newNewsDescription"
                                class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                placeholder="Description" rows="4"></textarea>

                            <label class="block">
                                <span class="text-gray-700 font-medium">Upload Image</span>
                                <input type="file" id="newNewsImage"
                                    class="w-full mt-2 border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                    accept="image/*" />
                            </label>
                        </div>

                        <div class="flex justify-end mt-6">
                            <button onclick="addNewNews()"
                                class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded mr-2 transition">
                                Add News
                            </button>

                            <button onclick="toggleAddNewsModal()"
                                class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="gallery" class="content-section p-8 bg-gray-200">
                <h2 class="text-3xl font-bold mb-6 text-midnight-blue text-center">
                    <i class="fas fa-images"></i> Gallery Section
                </h2>

                <!-- Button to show upload form -->
                <button id="show-upload-form-button"
                    class="bg-midnight-blue text-white py-2 px-4 rounded hover:bg-blue-700 transition duration-200 mb-6">
                    Upload New Image
                </button>

                <!-- Hidden Upload Image Form -->
                <div id="upload-image-form" class="mb-6 p-4 bg-white rounded-lg shadow-md hidden">
                    <h3 class="text-xl font-semibold mb-4">Upload New Image</h3>
                    <form id="image-upload-form" class="space-y-4">
                        <div class="flex flex-col">
                            <label for="imageType" class="text-sm font-medium">Image Type:</label>
                            <input type="text" id="imageType" class="p-2 border border-gray-300 rounded" required />
                        </div>
                        <div class="flex flex-col">
                            <label for="imageTitle" class="text-sm font-medium">Image Title:</label>
                            <input type="text" id="imageTitle" class="p-2 border border-gray-300 rounded" required />
                        </div>
                        <div class="flex flex-col">
                            <label for="imageFile" class="text-sm font-medium">Select Image:</label>
                            <input type="file" id="imageFile" accept="image/*"
                                class="p-2 border border-gray-300 rounded" required />
                        </div>
                        <button type="submit"
                            class="w-full bg-midnight-blue text-white py-2 rounded hover:bg-blue-700 transition duration-200">
                            Upload Image
                        </button>
                    </form>
                </div>

                <div id="gallery-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    <!-- Gallery items will be dynamically inserted here -->
                </div>

                <div id="image-navigation" class="hidden mt-6">
                    <button id="prev-button" class="nav-button bg-gray-300 p-2 rounded hover:bg-gray-400"
                        onclick="changeImage(-1)">
                        &#10094; Previous
                    </button>
                    <button id="next-button" class="nav-button bg-gray-300 p-2 rounded hover:bg-gray-400"
                        onclick="changeImage(1)">
                        Next &#10095;
                    </button>
                    <div id="current-image-display" class="mt-2 text-center">
                        <img id="displayed-image" src="" alt="" class="rounded-lg shadow-md mb-2" />
                        <h4 id="image-title" class="font-semibold"></h4>
                    </div>
                </div>

                <div id="hero-image-form" class="mb-6 p-4 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-semibold mb-4">Add Hero Images</h3>
                    <form id="add-hero-images-form" class="space-y-4">
                        <div class="flex flex-col">
                            <input type="file" id="heroImage1" accept="image/*"
                                class="p-2 border border-gray-300 rounded" required />
                            <input type="file" id="heroImage2" accept="image/*"
                                class="p-2 border border-gray-300 rounded" required />
                            <input type="file" id="heroImage3" accept="image/*"
                                class="p-2 border border-gray-300 rounded" required />
                        </div>
                        <button type="submit"
                            class="w-full bg-midnight-blue text-white py-2 rounded hover:bg-blue-700 transition duration-200">
                            Upload Hero Images
                        </button>
                    </form>
                </div>

                <!-- Current Hero Images Display -->
                <div id="current-hero-images" class="mt-6">
                    <h3 class="text-xl font-semibold mb-4">Current Hero Images</h3>
                    <div id="hero-image-container"
                        class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                        <!-- Hero images will be dynamically inserted here -->
                    </div>
                </div>
            </div>

            <script>
                // Get the elements
                const showUploadFormButton = document.getElementById(
                    "show-upload-form-button"
                );
                const uploadImageForm =
                    document.getElementById("upload-image-form");

                // Add event listener to button
                showUploadFormButton.addEventListener("click", function () {
                    // Toggle the form's visibility
                    uploadImageForm.classList.toggle("hidden");
                });
            </script>

            <div id="timetable-section" class="content-section p-8 bg-gray-100">
                <h2 class="text-2xl font-bold mb-4 text-midnight-blue">
                    <i class="fas fa-calendar-alt"></i> Set School Timetable
                </h2>
                <form id="timetable-form" class="mb-4">
                    <label for="class-name">Class:</label>
                    <select id="class-name" class="block w-full mb-2 " style="max-width: fit-content;" onchange="showTimetable()">
                        <option value="">Select a class</option>
                        <!-- Options populated dynamically -->
                    </select>
                </form>

<div id="timetable-container" class="hidden">
    <h3 class="text-xl font-bold mb-4">Set Timetable</h3>
    <table id="timetable-table" class="table-auto w-full bg-white">
        <thead>
            <tr>
                <th>Day</th>
                <th>Subjects</th>
                <th>Times</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr data-day="Monday">
                <td>Monday</td>
                <td>
                    <input type="text" class="subject-input block w-full" data-day="Monday">
                </td>
                <td>
                    <input type="text" class="time-input block w-full" data-day="Monday">
                </td>
                <td>
                    <button class="add-subject bg-transparent text-green-500 p-1 rounded-full" onclick="addSubject('Monday')">
                        <i class="fas fa-plus"></i>
                    </button>
                </td>
            </tr>
            <tr data-day="Tuesday">
                <td>Tuesday</td>
                <td>
                    <input type="text" class="subject-input block w-full" data-day="Tuesday">
                </td>
                <td>
                    <input type="text" class="time-input block w-full" data-day="Tuesday">
                </td>
                <td>
                    <button class="add-subject bg-transparent text-green-500 p-1 rounded-full" onclick="addSubject('Tuesday')">
                        <i class="fas fa-plus"></i>
                    </button>
                </td>
            </tr>
            <tr data-day="Wednesday">
                <td>Wednesday</td>
                <td>
                    <input type="text" class="subject-input block w-full" data-day="Wednesday">
                </td>
                <td>
                    <input type="text" class="time-input block w-full" data-day="Wednesday">
                </td>
                <td>
                    <button class="add-subject bg-transparent text-green-500 p-1 rounded-full" onclick="addSubject('Wednesday')">
                        <i class="fas fa-plus"></i>
                    </button>
                </td>
            </tr>
            <tr data-day="Thursday">
                <td>Thursday</td>
                <td>
                    <input type="text" class="subject-input block w-full" data-day="Thursday">
                </td>
                <td>
                    <input type="text" class="time-input block w-full" data-day="Thursday">
                </td>
                <td>
                    <button class="add-subject bg-transparent text-green-500 p-1 rounded-full" onclick="addSubject('Thursday')">
                        <i class="fas fa-plus"></i>
                    </button>
                </td>
            </tr>
            <tr data-day="Friday">
                <td>Friday</td>
                <td>
                    <input type="text" class="subject-input block w-full" data-day="Friday">
                </td>
                <td>
                    <input type="text" class="time-input block w-full" data-day="Friday">
                </td>
                <td>
                    <button class="add-subject bg-transparent text-green-500 p-1 rounded-full" onclick="addSubject('Friday')">
                        <i class="fas fa-plus"></i>
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
    <button id="save-timetable" class="bg-blue-500 text-white p-2 rounded mt-4">Save Timetable</button>
</div>
            <div id="settings" class="content-section p-8 bg-gray-200">
                <h2 class="text-2xl font-bold mb-4 text-midnight-blue">
                    <i class="fas fa-cog"></i> Settings Section
                </h2>
                <div class="space-y-4">
                    <!-- Example Setting -->
                    <div class="bg-white shadow-md rounded p-4">
                        <h3 class="text-lg font-semibold">Profile Settings</h3>
                        <div class="flex items-center mt-2">
                            <label for="profile-name" class="w-1/3">Name:</label>
                            <input id="profile-name" type="text" class="w-2/3 p-2 border rounded"
                                placeholder="John Doe" />
                        </div>
                    </div>
                    <!-- More settings forms as needed -->
                </div>
            </div>
    </div>
    </div>
    </div>

    <!-- Firebase and other scripts -->
    <!-- JavaScript libraries -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/js/lightbox.min.js"></script>
    <script src="admin.js"></script>
    <script>
        const applicationsTable = document.querySelector("#applications-table tbody");
    
        // Fetch applications from 'applications' collection
        function fetchApplications() {
            db.collection("applications").onSnapshot((snapshot) => {
                applicationsTable.innerHTML = ""; // Clear the table
                snapshot.forEach((doc) => {
                    const data = doc.data();
                    const row = `
                        <tr data-id="${doc.id}">
                            <td>${data.id}</td>
                            <td>${data.firstName}</td>
                            <td>${data.lastName}</td>
                            <td>${data.dob}</td>
                            <td>${data.gender}</td>
                            <td>${data.email}</td>
                            <td>${data.phone}</td>
                            <td>${data.address}</td>
                            <td>${data.previousSchool || ""}</td>
                            <td>${data.className || ""}</td>
                            <td><a href="${data.certificateURL}">View Results</a></td>
                            <td>${data.results || ""}</td>
                            <td>
                                <button class="approve-button text-green-500" onclick="moveToStudents('${doc.id}', '${data.id}')">
                                    <i class="fas fa-check text-success bg-transparent"></i>
                                </button>
                                <button class="delete-button text-red-500 bg-black" onclick="deleteApplication('${doc.id}')">
                                    <i class="fas fa-trash text-red bg-transparent"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                    applicationsTable.innerHTML += row;
                });
            });
        }
    
        fetchApplications(); // Call to fetch applications
    
        function getNextUserId() {
            return db.collection("counters").doc("userCounter").get().then((doc) => {
                if (doc.exists) {
                    const lastUserId = doc.data().lastUserId;
                    const newUserId = lastUserId + 1;
                    return db.collection("counters").doc("userCounter").update({
                        lastUserId: newUserId,
                    }).then(() => newUserId);
                } else {
                    const initialUserId = 1111;
                    return db.collection("counters").doc("userCounter").set({
                        lastUserId: initialUserId,
                    }).then(() => initialUserId);
                }
            });
        }
    
    function moveToStudents(docId, studentId) {
    const applicationRef = db.collection("applications").doc(docId);

    applicationRef.get().then((doc) => {
        if (doc.exists) {
            const applicationData = doc.data();

            // Check if a student with the same email already exists
            db.collection("students").where("email", "==", applicationData.email).get().then((querySnapshot) => {
                if (!querySnapshot.empty) {
                    // If a student with the same email exists, prevent approval
                    alert("A student with this email already exists. Approval denied.");
                } else {
                    // If no duplicate email is found, proceed with the approval
                    getNextUserId().then((userId) => {
                        applicationData.userId = userId;

                        // Add the application data to the students collection
                        db.collection("students").add(applicationData).then(() => {
                            const userData = {
                                userId: userId,
                                firstName: applicationData.firstName,
                                email: applicationData.email,
                                 userType: "student",
                            };

                            // Add data to users collection
                            db.collection("users").add(userData).then(() => {
                                // Delete the application document after approval
                                applicationRef.delete().then(() => {
                                    alert("Student approved with User ID: " + userId);
                                    document.querySelector(`tr[data-id='${docId}']`).remove();
                                }).catch((error) => {
                                    console.error("Error deleting application: ", error);
                                });
                            }).catch((error) => {
                                console.error("Error adding to users collection: ", error);
                            });
                        }).catch((error) => {
                            console.error("Error adding to students collection: ", error);
                        });
                    }).catch((error) => {
                        console.error("Error fetching next user ID: ", error);
                    });
                }
            }).catch((error) => {
                console.error("Error checking for existing students: ", error);
            });
        } else {
            console.log("No such application found!");
        }
    }).catch((error) => {
        console.error("Error fetching application: ", error);
    });
}

        function deleteApplication(docId) {
            if (confirm("Are you sure you want to delete this application?")) {
                db.collection("applications").doc(docId).delete().then(() => {
                    alert("Application deleted successfully.");
                    document.querySelector(`tr[data-id='${docId}']`).remove();
                }).catch((error) => {
                    console.error("Error deleting application: ", error);
                });
            }
        }
    </script>
    
    <script>
        const studentsTable = document.querySelector("#students-table tbody");
        const classFilter = document.getElementById("class-filter");
        const searchInput = document.getElementById("search-input");
        let allStudents = [];
    
        function fetchClasses() {
            db.collection("classes").get().then((querySnapshot) => {
                querySnapshot.forEach((doc) => {
                    const classData = doc.data();
                    const option = document.createElement("option");
                    option.value = classData.classID;
                    option.textContent = classData.className;
                    classFilter.appendChild(option);
                });
            }).catch((error) => {
                console.error("Error fetching classes: ", error);
            });
        }
    
        function fetchStudents() {
            db.collection("students").get().then((querySnapshot) => {
                allStudents = [];
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    allStudents.push({ id: doc.id, ...data });
                    displayStudentRow(doc.id, data);
                });
            }).catch((error) => {
                console.error("Error fetching students: ", error);
            });
        }
    
        function displayStudentRow(docId, data) {
            const row = `
                <tr data-id="${docId}">
                    <td>${data.id}</td>
                    <td><input type="text" value="${data.userId}" disabled/></td>
                    <td><input type="text" value="${data.firstName}" disabled/></td>
                    <td><input type="text" value="${data.lastName}" disabled/></td>
                    <td><input type="text" value="${data.dob}" disabled/></td>
                    <td><input type="text" value="${data.gender}" disabled/></td>
                    <td><input type="text" value="${data.email}" disabled/></td>
                    <td><input type="text" value="${data.phone}" disabled/></td>
                    <td><input type="text" value="${data.address}" disabled/></td>
                    <td><input type="text" value="${data.previousSchool || ""}" disabled/></td>
                    <td><input type="text" value="${data.className || ""}" disabled/></td>
                    <td><a href="${data.certificateURL}">View Results</a></td>
                    <td>
                        <button class="edit-button" onclick="editStudent('${docId}', this)">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="delete-button" onclick="deleteStudent('${docId}')">
                            <i class="fas fa-trash"></i>
                        </button>
                        <button class="save-button hidden" onclick="saveStudent('${docId}', this)">
                            <i class="fas fa-save"></i>
                        </button>
                    </td>
                </tr>
            `;
            studentsTable.innerHTML += row;
        }
    
        function filterStudents() {
            const selectedClassId = parseInt(classFilter.value, 10);
            const searchTerm = searchInput.value.toLowerCase();
            studentsTable.innerHTML = "";
    
            allStudents.forEach((student) => {
                const matchesClass = selectedClassId ? student.classID === selectedClassId : true;
                const matchesSearch = student.firstName.toLowerCase().includes(searchTerm) || student.lastName.toLowerCase().includes(searchTerm) || student.email.toLowerCase().includes(searchTerm);
    
                if (matchesClass && matchesSearch) {
                    displayStudentRow(student.id, student);
                }
            });
        }
    
        function editStudent(docId, button) {
            const row = button.closest("tr");
            row.querySelectorAll("input").forEach((input) => {
                input.disabled = false;
            });
            button.classList.add("hidden");
            row.querySelector(".save-button").classList.remove("hidden");
        }
    
        function saveStudent(docId, button) {
            const row = button.closest("tr");
            const updatedData = {
                userId: row.cells[1].querySelector("input").value,
                firstName: row.cells[2].querySelector("input").value,
                lastName: row.cells[3].querySelector("input").value,
                dob: row.cells[4].querySelector("input").value,
                gender: row.cells[5].querySelector("input").value,
                email: row.cells[6].querySelector("input").value,
                phone: row.cells[7].querySelector("input").value,
                address: row.cells[8].querySelector("input").value,
                previousSchool: row.cells[9].querySelector("input").value,
                className: row.cells[10].querySelector("input").value,
            };
    
            db.collection("students").doc(docId).update(updatedData).then(() => {
                alert("Student information updated successfully.");
                row.querySelectorAll("input").forEach((input) => {
                    input.disabled = true;
                });
                button.classList.add("hidden");
                row.querySelector(".edit-button").classList.remove("hidden");
            }).catch((error) => {
                console.error("Error updating student: ", error);
            });
        }
    
        function deleteStudent(docId) {
            if (confirm("Are you sure you want to delete this student?")) {
                db.collection("students").doc(docId).delete().then(() => {
                    alert("Student deleted successfully.");
                    document.querySelector(`tr[data-id='${docId}']`).remove();
                }).catch((error) => {
                    console.error("Error deleting student: ", error);
                });
            }
        }
    
        classFilter.addEventListener("change", filterStudents);
        searchInput.addEventListener("input", filterStudents);
    
        fetchClasses();
        fetchStudents();
    </script>
    
   <script>
    const timetableForm = document.querySelector("#timetable-form");
    const classSelect = document.querySelector("#class-name");
    const timetableContainer = document.querySelector("#timetable-container");
    const saveTimetableButton = document.querySelector("#save-timetable");

    // Fetch classes to populate dropdown
    function fetchClasses() {
        db.collection("classes")
            .get()
            .then((snapshot) => {
                classSelect.innerHTML = '<option value="">Select a class</option>'; // Clear and set default option
                snapshot.forEach((doc) => {
                    const data = doc.data();
                    const option = document.createElement("option");
                    option.value = doc.id; // Use the class ID
                    option.textContent = data.className || "Unknown Class"; // Display class name
                    classSelect.appendChild(option);
                });
            })
            .catch((error) => {
                console.error("Error fetching classes: ", error);
            });
    }

    // Show timetable container when a class is selected
    function showTimetable() {
        const classId = classSelect.value;
        if (classId) {
            timetableContainer.classList.remove("hidden");
            clearTimetableInputs(); // Clear inputs before fetching new timetable
            fetchTimetable(classId); // Fetch timetable for the selected class
        } else {
            timetableContainer.classList.add("hidden");
        }
    }

    // Fetch and display existing timetable for the selected class
    function fetchTimetable(classId) {
        db.collection("classes")
            .doc(classId)
            .get()
            .then((doc) => {
                if (doc.exists && doc.data().timeTable) {
                    const timetable = doc.data().timeTable;
                    for (const day in timetable) {
                        const subjects = timetable[day].subjects || [];
                        const times = timetable[day].times || [];
                        const subjectInput = document.querySelector(`.subject-input[data-day="${day}"]`);
                        const timeInput = document.querySelector(`.time-input[data-day="${day}"]`);

                        subjectInput.value = subjects.join(', ');
                        timeInput.value = times.join(', '); // Ensure time values are displayed as they were saved
                    }
                } else {
                    // If no timetable exists, clear all inputs for a new entry
                    clearTimetableInputs();
                }
            })
            .catch((error) => {
                console.error("Error fetching timetable: ", error);
            });
    }

    // Function to clear timetable inputs for a new timetable
    function clearTimetableInputs() {
        const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
        days.forEach(day => {
            document.querySelector(`.subject-input[data-day="${day}"]`).value = '';
            document.querySelector(`.time-input[data-day="${day}"]`).value = '';
        });
    }

    // Function to add a new subject input for a specific day
    function addSubject(day) {
        const subjectInput = document.querySelector(`.subject-input[data-day="${day}"]`);
        const timeInput = document.querySelector(`.time-input[data-day="${day}"]`);

        // Check for empty inputs before adding
        if (subjectInput.value && timeInput.value) {
            const subjects = subjectInput.value.split(',').map(sub => sub.trim());
            const times = timeInput.value.split(',').map(t => t.trim());

            if (subjects.length < 6) {
                subjects.push('');
                subjectInput.value = subjects.join(', ');
                times.push(''); // Insert an empty time field
                timeInput.value = times.join(', ');
            } else {
                alert("Maximum of 6 subjects per day reached.");
            }
        } else {
            alert("Please fill in both subject and time before adding.");
        }
    }

    // Handle timetable save
    saveTimetableButton.addEventListener("click", () => {
        const classId = classSelect.value;
        if (!classId) return;

        const timetableData = {};
        const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];

        days.forEach(day => {
            const subjectInput = document.querySelector(`.subject-input[data-day="${day}"]`);
            const timeInput = document.querySelector(`.time-input[data-day="${day}"]`);

            const subjects = subjectInput.value.split(',').map(sub => sub.trim()).filter(Boolean);
            const times = timeInput.value.split(',').map(t => t.trim()).filter(Boolean); // Ensure time is saved correctly

            if (subjects.length > 0 || times.length > 0) {
                timetableData[day] = { subjects, times }; // Store subjects and times as arrays in Firebase
            }
        });

        // Save timetable data as an inner document for the selected class in the classes collection
        db.collection("classes").doc(classId).update({
        timeTable: timetableData,
        className: className // Include className in the update
        })
            .then(() => {
                alert("Timetable saved successfully!");
            })
            .catch((error) => {
                console.error("Error saving timetable: ", error);
            });
    });

    // Initial fetch
    fetchClasses();
    classSelect.addEventListener('change', showTimetable); // Trigger timetable load on class selection
</script>

</body>

</html>